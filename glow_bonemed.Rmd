---
title: "glow_bonemed EDA"
author: "Derek Rogers, "
date: "2023-04-04"
output: 
  html_document:
    theme: cerulean
    fontsize: 16pt
  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE}
library(aplore3)
library(ggplot2)
library(plotly)
library(RColorBrewer)
library(pheatmap)
library(cluster)
```

```{r}

```

Data Format: A data.frame with 500 rows and 18 variables such as:

priorfrac - If the patient previously had a fracture<br>
age<br>
weight<br>
height<br>
bmi<br>
premeno<br>
momfrac<br>
armassist<br>
smoke<br>
raterisk<br>
fracscore<br>
fracture<br>
bonemed - Bone medications at enrollment (1: No, 2: Yes)<br>
bonemed_fu - Bone medications at follow-up (1: No, 2: Yes)<br>
bonetreat - Bone medications both at enrollment and follow-up (1: No, 2: Yes)<br>

```{r}
head(glow_bonemed)
```

```{r}
summary(glow_bonemed)
```


Age vs Weight: As weight increases the average age decreases<br>
Age vs Height: Weak correlation of as height increases age decreases<br>
Age vs BMI: As bmi increases the average age decreases<br>
Age vs fracscore: As age increases the average fracscore increases<br>

Weight vs Height: As height increases the average weight increases<br>
Weight vs BMI: As bmi increases the average weight increases<br>
Weight vs fracscore: As fracscore increases the average Weight decreases<br>

Height vs BMI: As bmi increases the average height and variance stay the same<br>
Height vs fracscore: As fracscore increases the average height stays the same though variance might decrease<br>

BMI vs fracscore: As fracscore increases the average bmi decreases<br>

```{r}
plot(glow_bonemed[, c(5:8, 14)])
```
Non of the following scatter plots show strong groupings for the fracture/no fracture categorical variable
```{r}
ggplot(glow_bonemed, aes(x = age, y = bmi, color = fracture)) +
  geom_jitter()
```
```{r}
ggplot(glow_bonemed, aes(x = bmi, y = fracscore, color = fracture)) +
  geom_jitter()
```

```{r}
ggplot(glow_bonemed, aes(x = fracscore, y = age, color = fracture)) +
  geom_jitter()
```

```{r}
ggplot(glow_bonemed, aes(x = weight, y = height, color = fracture)) +
  geom_jitter()
```

Once again there doesn't seem to be strong groupings of the fracture categorical variable

```{r}
fracture3dplot = plot_ly(glow_bonemed, 
  x = ~age, 
  y = ~height, 
  z = ~bmi, 
  color = ~fracture, 
  colors = c('#0C4B8E', '#BF382A')) %>% add_markers()

fracture3dplot
```

The boxplot shows that the mean fracscore seems to be slightly higher for smokers compared to non smokers

```{r}
ggplot(glow_bonemed, aes(x = smoke, y = fracscore)) +
  geom_boxplot()
```

# Clustering EDA




```{r}
pheatmap(glow_bonemed[, c(5,8)], scale = "column", fontsize_row = 0.1, cluster_cols = F, legend = T, color = colorRampPalette(c("blue", "white", "red"), space = "rgb")(100))
```



```{r}
pheatmap(glow_bonemed[, 5:8], scale = "column", fontsize_row = 0.1, cluster_cols = F, legend = T, color = colorRampPalette(c("blue", "white", "red"), space = "rgb")(100))
```



```{r}
zScoreScale = scale(glow_bonemed[, 5:8])

zScoreDistance = dist(zScoreScale)

continuousVariableClustering = hclust(zScoreDistance, method = "complete")

plot(continuousVariableClustering)
```

Sources:<br>
  Hosmer, D.W., Lemeshow, S. and Sturdivant, R.X. (2013) Applied Logistic Regression, 3rd ed.,
  New York: Wiley
  
  https://cran.r-project.org/web/packages/aplore3/aplore3.pdf#page=11&zoom=100,132,90